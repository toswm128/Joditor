{"ast":null,"code":"import WriteEditorState from \"./state\";\nimport produce from \"immer\";\nimport { ADD_LINE, CLOSE_TAG_BOX, DROP_IMG, DROP_LINE, FOCUS_LINE, FOCUS_NEXT_LINE, FOCUS_NEXT_TAG, FOCUS_PREV_LINE, FOCUS_PREV_TAG, FOCUS_SET_UP_TAG, OPEN_TAG_BOX, PUT_SET_UP, REDO, REMOVE_LINE, REMOVE_LINE_ONLY, RESET, SEARCH_TAG, SET_BANNER, SET_IMG, SET_LINE_TEXT, SET_TAG_TO_A, SET_TAG_TO_CALL_OUT, SET_TAG_TO_CODE, SET_TAG_TO_H1, SET_TAG_TO_H2, SET_TAG_TO_H3, SET_TAG_TO_UL, SET_TITLE, UNDO, UNSET_IMG } from \"./actions\";\nimport { createReducer } from \"typesafe-actions\";\nexport default _c = createReducer(WriteEditorState, {\n  [SET_LINE_TEXT]: (state, action) => produce(state, draft => {\n    draft.body[action.payload.id].text = action.payload.text;\n    draft.trashList.push({\n      type: SET_LINE_TEXT,\n      payload: {\n        id: action.payload.id,\n        text: draft.body[action.payload.id].text\n      }\n    });\n  }),\n  [FOCUS_LINE]: (state, action) => produce(state, draft => {\n    draft.focusLine = action.payload;\n  }),\n  [ADD_LINE]: (state, action) => produce(state, draft => {\n    draft.focusLine = draft.body.length;\n    draft.body.push({\n      id: draft.body.length,\n      text: \"\",\n      tag: \"div\",\n      next: action.payload.next,\n      prev: action.payload.id,\n      src: \"\"\n    });\n    draft.body[action.payload.id].next = draft.body.length - 1;\n    if (action.payload.next !== null) draft.body[action.payload.next].prev = draft.body.length - 1;\n    draft.trashList.push({\n      type: ADD_LINE,\n      payload: {\n        id: draft.body.length - 1,\n        next: action.payload.next,\n        prev: action.payload.id\n      }\n    });\n  }),\n  [REMOVE_LINE]: (state, action) => produce(state, draft => {\n    draft.focusIndex = 9999; // delete draft.body[action.payload.id];\n\n    if (draft.head !== action.payload.id) {\n      draft.body[action.payload.prev].next = action.payload.next;\n      draft.focusLine = action.payload.prev;\n    } else {\n      draft.head = action.payload.next;\n      draft.focusLine = action.payload.next;\n    }\n\n    if (action.payload.next !== null) draft.body[action.payload.next].prev = action.payload.prev;\n    draft.setTexter = !draft.setTexter;\n  }),\n  [REMOVE_LINE_ONLY]: (state, action) => produce(state, draft => {\n    // delete draft.body[action.payload.id];\n    if (draft.head !== action.payload.id) {\n      if (draft.updatter !== 1) {\n        draft.trashList.splice(draft.trashList.length - draft.updatter, draft.trashList.length - 1);\n        draft.updatter = 1;\n      }\n\n      draft.focusIndex = draft.body[action.payload.prev].text.length;\n      draft.body[action.payload.prev].text += draft.body[action.payload.id].text;\n      draft.body[action.payload.prev].next = action.payload.next;\n      if (action.payload.next !== null) draft.body[action.payload.next].prev = action.payload.prev;\n      draft.focusLine = action.payload.prev;\n    }\n  }),\n  [DROP_LINE]: (state, action) => produce(state, draft => {\n    const source = draft.body[action.payload.id];\n    const nextS = source.next;\n    const prevS = source.prev;\n    const idS = source.id;\n    const destination = draft.body[action.payload.destinationID];\n    const nextD = destination.next;\n    const prevD = destination.prev;\n    const idD = destination.id;\n\n    if (Math.abs(action.payload.source - action.payload.destination) === 1) {\n      if (action.payload.source > action.payload.destination) {\n        if (prevD !== null) {\n          draft.body[prevD].next = idS;\n        } else draft.head = idS;\n\n        draft.body[idS].prev = prevD;\n        draft.body[idS].next = idD;\n        draft.body[idD].prev = idS;\n        draft.body[idD].next = nextS;\n\n        if (nextS !== null) {\n          draft.body[nextS].prev = idD;\n        }\n      } else if (action.payload.source < action.payload.destination) {\n        if (prevS !== null) {\n          draft.body[prevS].next = idD;\n        } else draft.head = idD;\n\n        draft.body[idD].prev = prevS;\n        draft.body[idD].next = idS;\n        draft.body[idS].prev = idD;\n        draft.body[idS].next = nextD;\n\n        if (nextD !== null) {\n          draft.body[nextD].prev = idS;\n        }\n      }\n    } else {\n      if (action.payload.source > action.payload.destination) {\n        if (prevD !== null) {\n          draft.body[prevD].next = idS;\n        } else draft.head = idS;\n\n        draft.body[idS].prev = prevD;\n        draft.body[idS].next = idD;\n        draft.body[idD].prev = idS;\n\n        if (prevS !== null) {\n          draft.body[prevS].next = nextS;\n        }\n\n        if (nextS !== null) {\n          draft.body[nextS].prev = prevS;\n        }\n      } else if (action.payload.source < action.payload.destination) {\n        if (prevS !== null) {\n          draft.body[prevS].next = nextS;\n        } else if (nextS !== null) draft.head = nextS;\n\n        draft.body[idS].prev = idD;\n        draft.body[idS].next = nextD;\n        draft.body[idD].next = idS;\n\n        if (nextS !== null) {\n          draft.body[nextS].prev = prevS;\n        }\n\n        if (nextD !== null) {\n          draft.body[nextD].prev = idS;\n        }\n      }\n    }\n  }),\n  [SET_IMG]: (state, action) => produce(state, draft => {\n    draft.body[action.payload.id].src = action.payload.src;\n    if (draft.body[action.payload.id].next !== null) draft.focusLine = draft.body[action.payload.id].next;else draft.focusLine = draft.body[action.payload.id].prev;\n  }),\n  [UNSET_IMG]: (state, action) => produce(state, draft => {\n    draft.body[action.payload].tag = \"div\";\n    draft.body[action.payload].src = \"\";\n    draft.focusLine = action.payload;\n  }),\n  [DROP_IMG]: (state, action) => produce(state, draft => {\n    const id = action.payload.id;\n    if (draft.body[id].next !== null) draft.focusLine = draft.body[id].next;else draft.focusLine = draft.body[id].prev;\n    if (draft.body[id].next !== null) draft.body[draft.body[id].next].prev = draft.body.length - 1;\n    draft.body.push({\n      id: draft.body.length,\n      text: \"\",\n      tag: action.payload.isA ? \"img\" : \"a\",\n      next: draft.body[id].next,\n      prev: id,\n      src: action.payload.src\n    });\n    draft.body[id].next = draft.body.length - 1;\n  }),\n  [SET_TAG_TO_UL]: (state, action) => produce(state, draft => {\n    draft.body[action.payload.id].tag = \"ul\";\n    draft.focusIndex = action.payload.focusIndex;\n  }),\n  [SET_TAG_TO_H1]: (state, action) => produce(state, draft => {\n    draft.body[action.payload].tag = \"h1\";\n  }),\n  [SET_TAG_TO_H2]: (state, action) => produce(state, draft => {\n    draft.body[action.payload].tag = \"h2\";\n  }),\n  [SET_TAG_TO_H3]: (state, action) => produce(state, draft => {\n    draft.body[action.payload].tag = \"h3\";\n  }),\n  [SET_TAG_TO_A]: (state, action) => produce(state, draft => {\n    draft.body[action.payload].tag = \"a\";\n  }),\n  [SET_TAG_TO_CODE]: (state, action) => produce(state, draft => {\n    draft.body[action.payload].tag = \"code\";\n  }),\n  [SET_TAG_TO_CALL_OUT]: (state, action) => produce(state, draft => {\n    draft.body[action.payload].tag = \"callOut\";\n  }),\n  [SEARCH_TAG]: (state, action) => produce(state, draft => {\n    draft.searchWord = action.payload;\n  }),\n  [FOCUS_NEXT_LINE]: (state, action) => produce(state, draft => {\n    draft.setFocuser = !draft.setFocuser;\n    draft.focusLine = draft.body[action.payload.id].next;\n    draft.focusIndex = action.payload.focusIndex;\n  }),\n  [FOCUS_PREV_LINE]: (state, action) => produce(state, draft => {\n    draft.setFocuser = !draft.setFocuser;\n    draft.focusLine = draft.body[action.payload.id].prev;\n    draft.focusIndex = action.payload.focusIndex;\n  }),\n  [UNDO]: state => produce(state, draft => {\n    draft.trashList.length && draft.recycleList.push(draft.trashList[draft.trashList.length - 1]);\n    const trash = draft.trashList.pop();\n\n    switch (trash === null || trash === void 0 ? void 0 : trash.type) {\n      case SET_LINE_TEXT:\n        draft.body[trash.payload.id].text = trash.payload.text;\n        draft.focusLine = trash.payload.id;\n        break;\n\n      case ADD_LINE:\n        draft.body[trash.payload.prev].next = trash.payload.next;\n        draft.body[trash.payload.next].prev = trash.payload.prev;\n    }\n\n    draft.updatter += 1;\n  }),\n  [REDO]: state => produce(state, draft => {\n    draft.recycleList.length && draft.trashList.push(draft.recycleList[draft.recycleList.length - 1]);\n    const recyclables = draft.recycleList.pop();\n\n    switch (recyclables === null || recyclables === void 0 ? void 0 : recyclables.type) {\n      case SET_LINE_TEXT:\n        draft.body[recyclables.payload.id].text = recyclables.payload.text;\n        draft.focusLine = recyclables.payload.id;\n        break;\n\n      case ADD_LINE:\n        draft.body[recyclables.payload.prev].next = recyclables.payload.id;\n        draft.body[recyclables.payload.next].prev = recyclables.payload.id;\n    }\n\n    draft.updatter += 1;\n  }),\n  [SET_BANNER]: (state, action) => produce(state, draft => {\n    draft.banner = action.payload;\n  }),\n  [SET_TITLE]: (state, action) => produce(state, draft => {\n    draft.title = action.payload;\n  }),\n  [RESET]: state => produce(state, draft => {\n    draft.body = [{\n      id: 0,\n      text: \"\",\n      tag: \"div\",\n      next: null,\n      prev: null,\n      src: \"\"\n    }];\n    draft.trashList = [];\n    draft.recycleList = [];\n    draft.title = \"\";\n    draft.banner = undefined;\n    draft.updatter = 1;\n    draft.focusLine = 0;\n    draft.head = 0;\n    draft.focusIndex = 999999;\n    draft.setTexter = false;\n    draft.setFocuser = false;\n    draft.putId = \"\";\n  }),\n  [OPEN_TAG_BOX]: (state, action) => produce(state, draft => {\n    draft.tagBoxId = action.payload;\n  }),\n  [CLOSE_TAG_BOX]: state => produce(state, draft => {\n    draft.tagBoxId = null;\n    draft.searchWord = null;\n  }),\n  [FOCUS_NEXT_TAG]: state => produce(state, draft => {\n    if (draft.tagBoxFocusIdx === null) {\n      draft.tagBoxFocusIdx = 0;\n    } else {\n      draft.tagBoxFocusIdx += 1;\n    }\n  }),\n  [FOCUS_PREV_TAG]: state => produce(state, draft => {\n    if (draft.tagBoxFocusIdx === null) {\n      draft.tagBoxFocusIdx = 0;\n    } else {\n      draft.tagBoxFocusIdx && (draft.tagBoxFocusIdx -= 1);\n    }\n  }),\n  [FOCUS_SET_UP_TAG]: state => produce(state, draft => {\n    draft.tagBoxFocusIdx = null;\n  }),\n  [PUT_SET_UP]: (state, action) => produce(state, draft => {\n    draft.body = action.payload.body;\n    draft.title = action.payload.title;\n    draft.putId = action.payload.id;\n  })\n});\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/Users/jominsu/Documents/GitHub/Joditor/src/lib/Store/WriteEditorStore/reducer.ts"],"names":["WriteEditorState","produce","ADD_LINE","CLOSE_TAG_BOX","DROP_IMG","DROP_LINE","FOCUS_LINE","FOCUS_NEXT_LINE","FOCUS_NEXT_TAG","FOCUS_PREV_LINE","FOCUS_PREV_TAG","FOCUS_SET_UP_TAG","OPEN_TAG_BOX","PUT_SET_UP","REDO","REMOVE_LINE","REMOVE_LINE_ONLY","RESET","SEARCH_TAG","SET_BANNER","SET_IMG","SET_LINE_TEXT","SET_TAG_TO_A","SET_TAG_TO_CALL_OUT","SET_TAG_TO_CODE","SET_TAG_TO_H1","SET_TAG_TO_H2","SET_TAG_TO_H3","SET_TAG_TO_UL","SET_TITLE","UNDO","UNSET_IMG","createReducer","state","action","draft","body","payload","id","text","trashList","push","type","focusLine","length","tag","next","prev","src","focusIndex","head","setTexter","updatter","splice","source","nextS","prevS","idS","destination","destinationID","nextD","prevD","idD","Math","abs","isA","searchWord","setFocuser","recycleList","trash","pop","recyclables","banner","title","undefined","putId","tagBoxId","tagBoxFocusIdx"],"mappings":"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","sourcesContent":["import WriteEditorState from \"./state\";\nimport produce from \"immer\";\nimport {\n  ADD_LINE,\n  CLOSE_TAG_BOX,\n  DROP_IMG,\n  DROP_LINE,\n  FOCUS_LINE,\n  FOCUS_NEXT_LINE,\n  FOCUS_NEXT_TAG,\n  FOCUS_PREV_LINE,\n  FOCUS_PREV_TAG,\n  FOCUS_SET_UP_TAG,\n  OPEN_TAG_BOX,\n  PUT_SET_UP,\n  REDO,\n  REMOVE_LINE,\n  REMOVE_LINE_ONLY,\n  RESET,\n  SEARCH_TAG,\n  SET_BANNER,\n  SET_IMG,\n  SET_LINE_TEXT,\n  SET_TAG_TO_A,\n  SET_TAG_TO_CALL_OUT,\n  SET_TAG_TO_CODE,\n  SET_TAG_TO_H1,\n  SET_TAG_TO_H2,\n  SET_TAG_TO_H3,\n  SET_TAG_TO_UL,\n  SET_TITLE,\n  UNDO,\n  UNSET_IMG,\n} from \"./actions\";\nimport { WriteEditorStateType } from \"./type\";\nimport { createReducer } from \"typesafe-actions\";\n\nexport default createReducer<WriteEditorStateType>(WriteEditorState, {\n  [SET_LINE_TEXT]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload.id].text = action.payload.text;\n      draft.trashList.push({\n        type: SET_LINE_TEXT,\n        payload: {\n          id: action.payload.id,\n          text: draft.body[action.payload.id].text,\n        },\n      });\n    }),\n  [FOCUS_LINE]: (state, action) =>\n    produce(state, (draft) => {\n      draft.focusLine = action.payload;\n    }),\n  [ADD_LINE]: (state, action) =>\n    produce(state, (draft) => {\n      draft.focusLine = draft.body.length;\n      draft.body.push({\n        id: draft.body.length,\n        text: \"\",\n        tag: \"div\",\n        next: action.payload.next,\n        prev: action.payload.id,\n        src: \"\",\n      });\n      draft.body[action.payload.id].next = draft.body.length - 1;\n      if (action.payload.next !== null)\n        draft.body[action.payload.next].prev = draft.body.length - 1;\n      draft.trashList.push({\n        type: ADD_LINE,\n        payload: {\n          id: draft.body.length - 1,\n          next: action.payload.next,\n          prev: action.payload.id,\n        },\n      });\n    }),\n  [REMOVE_LINE]: (state, action) =>\n    produce(state, (draft) => {\n      draft.focusIndex = 9999;\n      // delete draft.body[action.payload.id];\n\n      if (draft.head !== action.payload.id) {\n        draft.body[action.payload.prev].next = action.payload.next;\n        draft.focusLine = action.payload.prev;\n      } else {\n        draft.head = action.payload.next;\n        draft.focusLine = action.payload.next;\n      }\n      if (action.payload.next !== null)\n        draft.body[action.payload.next].prev = action.payload.prev;\n      draft.setTexter = !draft.setTexter;\n    }),\n  [REMOVE_LINE_ONLY]: (state, action) =>\n    produce(state, (draft) => {\n      // delete draft.body[action.payload.id];\n      if (draft.head !== action.payload.id) {\n        if (draft.updatter !== 1) {\n          draft.trashList.splice(\n            draft.trashList.length - draft.updatter,\n            draft.trashList.length - 1\n          );\n          draft.updatter = 1;\n        }\n        draft.focusIndex = draft.body[action.payload.prev].text.length;\n        draft.body[action.payload.prev].text +=\n          draft.body[action.payload.id].text;\n        draft.body[action.payload.prev].next = action.payload.next;\n        if (action.payload.next !== null)\n          draft.body[action.payload.next].prev = action.payload.prev;\n        draft.focusLine = action.payload.prev;\n      }\n    }),\n\n  [DROP_LINE]: (state, action) =>\n    produce(state, (draft) => {\n      const source = draft.body[action.payload.id];\n      const nextS = source.next;\n      const prevS = source.prev;\n      const idS = source.id;\n      const destination = draft.body[action.payload.destinationID];\n      const nextD = destination.next;\n      const prevD = destination.prev;\n      const idD = destination.id;\n\n      if (Math.abs(action.payload.source - action.payload.destination) === 1) {\n        if (action.payload.source > action.payload.destination) {\n          if (prevD !== null) {\n            draft.body[prevD].next = idS;\n          } else draft.head = idS;\n          draft.body[idS].prev = prevD;\n          draft.body[idS].next = idD;\n          draft.body[idD].prev = idS;\n          draft.body[idD].next = nextS;\n          if (nextS !== null) {\n            draft.body[nextS].prev = idD;\n          }\n        } else if (action.payload.source < action.payload.destination) {\n          if (prevS !== null) {\n            draft.body[prevS].next = idD;\n          } else draft.head = idD;\n          draft.body[idD].prev = prevS;\n          draft.body[idD].next = idS;\n          draft.body[idS].prev = idD;\n          draft.body[idS].next = nextD;\n          if (nextD !== null) {\n            draft.body[nextD].prev = idS;\n          }\n        }\n      } else {\n        if (action.payload.source > action.payload.destination) {\n          if (prevD !== null) {\n            draft.body[prevD].next = idS;\n          } else draft.head = idS;\n\n          draft.body[idS].prev = prevD;\n          draft.body[idS].next = idD;\n          draft.body[idD].prev = idS;\n          if (prevS !== null) {\n            draft.body[prevS].next = nextS;\n          }\n          if (nextS !== null) {\n            draft.body[nextS].prev = prevS;\n          }\n        } else if (action.payload.source < action.payload.destination) {\n          if (prevS !== null) {\n            draft.body[prevS].next = nextS;\n          } else if (nextS !== null) draft.head = nextS;\n          draft.body[idS].prev = idD;\n          draft.body[idS].next = nextD;\n          draft.body[idD].next = idS;\n          if (nextS !== null) {\n            draft.body[nextS].prev = prevS;\n          }\n          if (nextD !== null) {\n            draft.body[nextD].prev = idS;\n          }\n        }\n      }\n    }),\n\n  [SET_IMG]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload.id].src = action.payload.src;\n      if (draft.body[action.payload.id].next !== null)\n        draft.focusLine = draft.body[action.payload.id].next;\n      else draft.focusLine = draft.body[action.payload.id].prev;\n    }),\n  [UNSET_IMG]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload].tag = \"div\";\n      draft.body[action.payload].src = \"\";\n      draft.focusLine = action.payload;\n    }),\n  [DROP_IMG]: (state, action) =>\n    produce(state, (draft) => {\n      const id = action.payload.id;\n      if (draft.body[id].next !== null) draft.focusLine = draft.body[id].next;\n      else draft.focusLine = draft.body[id].prev;\n      if (draft.body[id].next !== null)\n        draft.body[draft.body[id].next!].prev = draft.body.length - 1;\n\n      draft.body.push({\n        id: draft.body.length,\n        text: \"\",\n        tag: action.payload.isA ? \"img\" : \"a\",\n        next: draft.body[id].next,\n        prev: id,\n        src: action.payload.src,\n      });\n      draft.body[id].next = draft.body.length - 1;\n    }),\n  [SET_TAG_TO_UL]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload.id].tag = \"ul\";\n      draft.focusIndex = action.payload.focusIndex;\n    }),\n  [SET_TAG_TO_H1]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload].tag = \"h1\";\n    }),\n  [SET_TAG_TO_H2]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload].tag = \"h2\";\n    }),\n  [SET_TAG_TO_H3]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload].tag = \"h3\";\n    }),\n  [SET_TAG_TO_A]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload].tag = \"a\";\n    }),\n  [SET_TAG_TO_CODE]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload].tag = \"code\";\n    }),\n  [SET_TAG_TO_CALL_OUT]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body[action.payload].tag = \"callOut\";\n    }),\n  [SEARCH_TAG]: (state, action) =>\n    produce(state, (draft) => {\n      draft.searchWord = action.payload;\n    }),\n  [FOCUS_NEXT_LINE]: (state, action) =>\n    produce(state, (draft) => {\n      draft.setFocuser = !draft.setFocuser;\n      draft.focusLine = draft.body[action.payload.id].next;\n      draft.focusIndex = action.payload.focusIndex;\n    }),\n  [FOCUS_PREV_LINE]: (state, action) =>\n    produce(state, (draft) => {\n      draft.setFocuser = !draft.setFocuser;\n      draft.focusLine = draft.body[action.payload.id].prev;\n      draft.focusIndex = action.payload.focusIndex;\n    }),\n\n  [UNDO]: (state) =>\n    produce(state, (draft) => {\n      draft.trashList.length &&\n        draft.recycleList.push(draft.trashList[draft.trashList.length - 1]);\n      const trash = draft.trashList.pop();\n      switch (trash?.type) {\n        case SET_LINE_TEXT:\n          draft.body[trash.payload.id].text = trash.payload.text;\n          draft.focusLine = trash.payload.id;\n          break;\n        case ADD_LINE:\n          draft.body[trash.payload.prev].next = trash.payload.next;\n          draft.body[trash.payload.next].prev = trash.payload.prev;\n      }\n\n      draft.updatter += 1;\n    }),\n  [REDO]: (state) =>\n    produce(state, (draft) => {\n      draft.recycleList.length &&\n        draft.trashList.push(draft.recycleList[draft.recycleList.length - 1]);\n      const recyclables = draft.recycleList.pop();\n      switch (recyclables?.type) {\n        case SET_LINE_TEXT:\n          draft.body[recyclables.payload.id].text = recyclables.payload.text;\n          draft.focusLine = recyclables.payload.id;\n          break;\n        case ADD_LINE:\n          draft.body[recyclables.payload.prev].next = recyclables.payload.id;\n          draft.body[recyclables.payload.next].prev = recyclables.payload.id;\n      }\n\n      draft.updatter += 1;\n    }),\n  [SET_BANNER]: (state, action) =>\n    produce(state, (draft) => {\n      draft.banner = action.payload;\n    }),\n  [SET_TITLE]: (state, action) =>\n    produce(state, (draft) => {\n      draft.title = action.payload;\n    }),\n  [RESET]: (state) =>\n    produce(state, (draft) => {\n      draft.body = [\n        {\n          id: 0,\n          text: \"\",\n          tag: \"div\",\n          next: null,\n          prev: null,\n          src: \"\",\n        },\n      ];\n      draft.trashList = [];\n      draft.recycleList = [];\n      draft.title = \"\";\n      draft.banner = undefined;\n      draft.updatter = 1;\n      draft.focusLine = 0;\n      draft.head = 0;\n      draft.focusIndex = 999999;\n      draft.setTexter = false;\n      draft.setFocuser = false;\n      draft.putId = \"\";\n    }),\n\n  [OPEN_TAG_BOX]: (state, action) =>\n    produce(state, (draft) => {\n      draft.tagBoxId = action.payload;\n    }),\n  [CLOSE_TAG_BOX]: (state) =>\n    produce(state, (draft) => {\n      draft.tagBoxId = null;\n      draft.searchWord = null;\n    }),\n\n  [FOCUS_NEXT_TAG]: (state) =>\n    produce(state, (draft) => {\n      if (draft.tagBoxFocusIdx === null) {\n        draft.tagBoxFocusIdx = 0;\n      } else {\n        draft.tagBoxFocusIdx += 1;\n      }\n    }),\n  [FOCUS_PREV_TAG]: (state) =>\n    produce(state, (draft) => {\n      if (draft.tagBoxFocusIdx === null) {\n        draft.tagBoxFocusIdx = 0;\n      } else {\n        draft.tagBoxFocusIdx && (draft.tagBoxFocusIdx -= 1);\n      }\n    }),\n  [FOCUS_SET_UP_TAG]: (state) =>\n    produce(state, (draft) => {\n      draft.tagBoxFocusIdx = null;\n    }),\n  [PUT_SET_UP]: (state, action) =>\n    produce(state, (draft) => {\n      draft.body = action.payload.body;\n      draft.title = action.payload.title;\n      draft.putId = action.payload.id;\n    }),\n});\n"]},"metadata":{},"sourceType":"module"}